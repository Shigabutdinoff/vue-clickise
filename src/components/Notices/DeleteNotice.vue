<script>
export default {
  name: 'DeleteNoticeButton',
  props: {
    noticeId: {
      type: Number,
      required: true,
    },
  },
  emits: ['noticeDeleted'],
  methods: {
    async deleteNotice() {
      try {
        const response = await this.deleteNoticeRequest();
        if (!response.ok) {
          throw new Error(`–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å id ${this.noticeId}`);
        }

        // –°–æ–æ–±—â–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—é –æ–± —É–¥–∞–ª–µ–Ω–∏–∏
        this.$emit('noticeDeleted', this.noticeId);
      } catch (error) {
        this.handleError(error);
      }
    },
    async deleteNoticeRequest() {
      return fetch(`http://localhost/api/notices/${this.noticeId}`, {
        method: 'DELETE',
      });
    },
    handleError(error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:', error);
    },
  },
};
</script>

<template>
  <button @click="deleteNotice" class="btn btn-danger">
    üóëÔ∏è
  </button>
</template>

<style scoped>
button {
  font-size: 0.9em;
}

button:hover {
  background-color: darkred;
}
</style>
